<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Rock v0.4.3 language documentation</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="intro.html">Introduction</a></li><li class="chapter-item expanded "><a href="quick_start.html"><strong aria-hidden="true">1.</strong> Quick start</a></li><li class="chapter-item expanded "><a href="language_reference.html"><strong aria-hidden="true">2.</strong> Language reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="primitives.html"><strong aria-hidden="true">2.1.</strong> Primitives</a></li><li class="chapter-item expanded "><a href="function_decl.html"><strong aria-hidden="true">2.2.</strong> Function</a></li><li class="chapter-item expanded "><a href="function_signature.html"><strong aria-hidden="true">2.3.</strong> Function signature</a></li><li class="chapter-item expanded "><a href="struct.html"><strong aria-hidden="true">2.4.</strong> Struct</a></li><li class="chapter-item expanded "><a href="trait.html"><strong aria-hidden="true">2.5.</strong> Trait</a></li><li class="chapter-item expanded "><a href="self.html"><strong aria-hidden="true">2.6.</strong> Self</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rock v0.4.3 language documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Rock is an experimental native language.</p>
<p>Its main goal is to mix some parts of popular functionnal languages like haskell or livescript with
the rigor of Rust while staying elegant and fast with minimal runtime</p>
<p>Rock is at an early development stage. Don't expect everything to work smoothly. (you have been warned)</p>
<pre><code class="language-haskell">struct Player
  level: Int64
  name: String

impl Player
  new: x -&gt;
    Player
      level: x
      name: &quot;MyName&quot;

impl Show Player
  @show: -&gt; @name + &quot;(&quot; + @level.show! + &quot;)&quot;

use std::print::printl

impl Print Player
  @print: -&gt; printl @

main: -&gt;
  let player = Player::new 42
  player.print!
</code></pre>
<p>Rock syntax is entierly based on indentation, like Livescript.<br />
Each whitespace count, and tabulations <code>\t</code> are prohibited.</p>
<p>The number of whitespace to make one level of indentation is taken from the first indent level.<br />
If your first indentation has two whitespaces, the rest of the file must have the same number of whitespace per level (here two)</p>
<p>We generally use two as a default, but you can use any number you want. Here is the same example with four whitespaces:</p>
<pre><code class="language-haskell">struct Player
    level: Int64
    name: String

impl Player
    new: x -&gt;
        Player
            level: x
            name: &quot;MyName&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="quick-start"><a class="header" href="#quick-start">Quick start</a></h1>
<p>The actual best way to start is to build and install Rock via cargo:</p>
<pre><code class="language-sh">cargo install --git https://github.com/Champii/Rock --locked
rock -V
</code></pre>
<p>Then to create a new empty project folder</p>
<pre><code class="language-sh">rock new my_project
cd my_project
</code></pre>
<p>The project folder should contain a <code>src</code> folder with a <code>src/main.rk</code> file that should look like this:</p>
<pre><code class="language-haskell">main: -&gt; &quot;Hello World !&quot;.print!
</code></pre>
<p>You can immediately build and run this default snippet with</p>
<pre><code class="language-sh">rock run
</code></pre>
<p>This should output</p>
<pre><code class="language-sh">Hello World !
</code></pre>
<p>The compiler has created a <code>build</code> folder containing your compiled executable <code>build/a.out</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="language-reference"><a class="header" href="#language-reference">Language reference</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="primitives"><a class="header" href="#primitives">Primitives</a></h1>
<p>Rock actually support some essential primitives.</p>
<h2 id="boolean"><a class="header" href="#boolean">Boolean</a></h2>
<p>The <code>Bool</code> type</p>
<pre><code class="language-haskell">main: -&gt; 
  true.print!
  false.print!
</code></pre>
<h2 id="integer"><a class="header" href="#integer">Integer</a></h2>
<p>The most stable integer is <code>Int64</code> and should be used until the rest follows.</p>
<pre><code class="language-haskell">main: -&gt; 0
</code></pre>
<p>Rock has an inference mechanism that automatically assign types to variables and primitives</p>
<p>Here the <code>main</code> function is special and has a fixed signature <code>(Int64)</code> so <code>0</code> is a <code>Int64</code><br />
You can learn more about <a href="./function_signature.html">Function signature</a></p>
<h2 id="float"><a class="header" href="#float">Float</a></h2>
<pre><code class="language-haskell">main: -&gt;
  let x = 2.2
  x.print!
</code></pre>
<h2 id="char"><a class="header" href="#char">Char</a></h2>
<pre><code class="language-haskell">main: -&gt; '*'.print!
</code></pre>
<h2 id="string"><a class="header" href="#string">String</a></h2>
<p>Strings are immutable (like in most language)</p>
<pre><code class="language-haskell">main: -&gt; (&quot;Hello&quot; + &quot; World!&quot;).print!
</code></pre>
<p>You can index them to get a <code>Char</code></p>
<pre><code class="language-haskell">second_char: -&gt; &quot;Hello&quot;[1]
</code></pre>
<p>Strings are 0-indexed</p>
<p>Both Strings and Chars accept some escaped characters:
<code>\\ \' \&quot; \n \r \0</code></p>
<p>In the future there will be a distinction between native <code>Str</code> and on-the-heap <code>String</code> like in Rust</p>
<h2 id="array"><a class="header" href="#array">Array</a></h2>
<p>There is very limited support for arrays, they are still in development.</p>
<pre><code class="language-haskell">main: -&gt;
  let a = [1, 2, 3]
  a[2] = 4
  a[2]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="function"><a class="header" href="#function">Function</a></h1>
<h2 id="syntax"><a class="header" href="#syntax">Syntax</a></h2>
<p>The function declaration format is:</p>
<pre><code class="language-haskell">function_name: arg1, arg2, arg3 -&gt; return_value
</code></pre>
<p>The function call format is:</p>
<pre><code class="language-haskell">function_name arg1, arg2, arg3
</code></pre>
<p>But you can add parenthesis</p>
<pre><code class="language-haskell">function_name(arg1, arg2, arg3)
</code></pre>
<p>Every Rock package must have a <code>./src/main.rk</code> file containing a <code>main</code> function</p>
<pre><code class="language-haskell">main: -&gt; &quot;Hello World!&quot;.print!
</code></pre>
<p>You can call functions with no args with a bang <code>!</code> like the <code>.print!</code> above or with
explicit parenthesis like <code>.print()</code><br />
But the idiomatic way is to avoid parenthesis as much as possible</p>
<pre><code class="language-haskell">add: x, y -&gt; x + y
main: -&gt; add 2, 3
</code></pre>
<p>Rock does not allow for uppercase identifiers, so you should embrace the snake case.
Uppercase names are reserved for custom types like <a href="./struct.html">Struct</a> or <a href="./trait.html">Trait</a></p>
<h2 id="polymorphism"><a class="header" href="#polymorphism">Polymorphism</a></h2>
<p>Every function in Rock is polymorphic by default, and only infer the types based on the caller and the return value of its body.
Multiple calls with different types will generate each corresponding function, just like the templates in C++ or in Rust, except the generic parameter is always implicit if no constraints have been made.</p>
<p>For example, lets declare the most polymorphic function of all, <code>id</code>:</p>
<pre><code class="language-haskell">id: x -&gt; x
</code></pre>
<p>This function takes a <code>x</code> argument and returns it. Here <code>x</code> can be of any type</p>
<pre><code class="language-haskell">main: -&gt;
  id 42
  id 6.66
  id &quot;Hello&quot;
  id my_custom_struct
</code></pre>
<p>The infered signature of the function is <code>id: a =&gt; a</code>, with <code>a</code> being any type</p>
<p>If we had changed the body of <code>id</code> to be:</p>
<pre><code class="language-haskell">id: x -&gt; x + x
</code></pre>
<p>the previous main would still work if all of the types implemented the <code>Num</code> trait from the stdlib, that provide implementation of <code>+</code> for the basic types</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="function-signature"><a class="header" href="#function-signature">Function signature</a></h1>
<h2 id="syntax-1"><a class="header" href="#syntax-1">Syntax</a></h2>
<pre><code class="language-haskell">foo: a =&gt; Int64 =&gt; String
foo: x, y -&gt; &quot;bar&quot;
</code></pre>
<p>Here, the <code>foo</code> function takes 2 arguments, of type <code>a</code> (generic) and <code>Int64</code>, and returns a <code>String</code>
The implementation ignore the two arguments and returns &quot;bar&quot;</p>
<p>A signature is always formed of at least one type.<br />
The last (or only) type is the return type</p>
<p>Functions can take functions as parameter, and must be representable in a signature:</p>
<pre><code class="language-haskell">my_func: a =&gt; (a =&gt; b) =&gt; b
my_func: x, f -&gt; f x

# A function of type (a =&gt; b) that resolves to (Int64 =&gt; String)
handler: x -&gt; x.show!

main: -&gt; my_func 42, handler .print!
</code></pre>
<p>Here the second argument of the function <code>my_func</code> is a function that take a generic type <code>a</code> and returns a type <code>b</code>, and the whole method returns a type <code>b</code></p>
<p>This outputs:</p>
<pre><code>42
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="structure"><a class="header" href="#structure">Structure</a></h1>
<h2 id="declaration"><a class="header" href="#declaration">Declaration:</a></h2>
<p>Here is the idiomatic way to declare a structure</p>
<pre><code class="language-haskell">struct Counter
  value: Int64
  name: String
</code></pre>
<p>This structure has two fields <code>value</code> and <code>name</code> with their types respectively <code>Int64</code> and <code>String</code></p>
<h2 id="implementation"><a class="header" href="#implementation">Implementation</a></h2>
<p>You can attach some methods to the structure, for example here a class-method <code>new</code>
that takes a <code>x</code> and is used as a constructor</p>
<p>The <code>increment</code> method is an instance-method that takes nothing, increments the <code>value</code> field by <code>1</code> and returns <code>@</code></p>
<pre><code class="language-haskell">impl Counter
  new: x -&gt;
    Counter 
      value: x
      name: &quot;Counter&quot;

  @increment: @-&gt;
    @value = @value + 1
</code></pre>
<p>You can learn more about the <code>@</code> parameter here: <a href="./self.html">Self</a></p>
<pre><code class="language-haskell">main: -&gt;
  Counter::new(41)
    .increment!
    .value
    .print!
</code></pre>
<p>This prints <code>42</code></p>
<hr />
<p>*Note: We could have written something more compact, but less readable</p>
<pre><code class="language-haskell">impl Counter
  new: x -&gt; Counter value: x, name: &quot;Counter&quot;
  @increment: @-&gt; @value = @value + 1

main: -&gt; Counter::new 41 .increment!.value.print!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="trait"><a class="header" href="#trait">Trait</a></h1>
<h2 id="declaration-1"><a class="header" href="#declaration-1">Declaration</a></h2>
<p>The trait feature is very similar to what Rust have<br />
You can define some 'interfaces' that has some methods, you can then implement them for your types.</p>
<p>For example, we will implement a trait that double itself with the <code>+</code> operator</p>
<pre><code class="language-haskell">trait CanDouble
  @double_me: @
</code></pre>
<p>We define a trait <code>CanDouble</code> and declare a method <code>double_me</code> that returns the generic self type <code>@</code>.</p>
<h2 id="implementation-1"><a class="header" href="#implementation-1">Implementation</a></h2>
<p>We can now implement the trait for any type we want, like <code>Int64</code></p>
<pre><code class="language-haskell">impl CanDouble Int64
  @double_me: -&gt; @ + @
</code></pre>
<p>We can then call this method:</p>
<pre><code class="language-haskell">main: -&gt; (2).double_me!.print!
</code></pre>
<p>This output</p>
<pre><code>4
</code></pre>
<h2 id="default-method"><a class="header" href="#default-method">Default method</a></h2>
<p>You can define trait methods that have a default implementation.<br />
That means you don't have to reimplement it for each type, but you can override the default implementation with your own if you need it.</p>
<pre><code class="language-haskell">trait CanDouble
  @double_me: -&gt; @ + @

impl CanDouble Int64

main: -&gt; (2).double_me!.print!
</code></pre>
<h3 id="overriding"><a class="header" href="#overriding">Overriding</a></h3>
<p>You can override a default implementation</p>
<pre><code class="language-haskell">trait CanDouble
  @double_me: -&gt; @ + @

impl CanDouble Int64
  @double_me: -&gt; @ * 2

main: -&gt; (2).double_me!.print!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="self"><a class="header" href="#self">Self</a></h1>
<h2 id="the-self-parameter"><a class="header" href="#the-self-parameter">The <code>self</code> parameter</a></h2>
<p>The <code>self</code> parameter is represented by the <code>@</code> symbol.</p>
<pre><code class="language-haskell">impl CanDouble Int64
  @double_me: -&gt; @ + @
</code></pre>
<p>This method desugars to:</p>
<pre><code class="language-haskell">impl CanDouble Int64
  double_me: self -&gt; self + self
</code></pre>
<p>Those are strictly equivalent, as <code>@</code> desugar to <code>self</code>
We can see that we also have a <code>@</code> at the start of the name of the method. This allows for auto-injection of the self-parameter:</p>
<h2 id="auto-inject-self-parameter"><a class="header" href="#auto-inject-self-parameter">Auto-inject self parameter</a></h2>
<p>The standard way of defining a self-method is to auto-inject the self parameter:</p>
<pre><code class="language-haskell">impl CanDouble Int64
  @double_me: -&gt; @ + @
</code></pre>
<h2 id="auto-return-self"><a class="header" href="#auto-return-self">Auto-return self</a></h2>
<p>And if you also wanted to return <code>self</code> for chainable capababilities:</p>
<pre><code class="language-haskell">impl CanDouble Int64
  @double_me: @-&gt;
    @ = @ + @

main: -&gt;
  let x = 2
  x.double_me!.double_me!.double_me!
  x.print!
</code></pre>
<p>Outputs</p>
<pre><code>16
</code></pre>
<p>The <code>@-&gt;</code> automatically inject the <code>@</code> as last returned statement of the function's body.
This operator is only available when using the <code>@method_name:</code> notation</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
